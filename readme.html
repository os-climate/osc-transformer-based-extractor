<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>OSC Transformer Based Extractor &#8212; osc-transformer-based-extractor unknown documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=0ca6144b" />
    <script src="_static/documentation_options.js?v=3f1b9271"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="osc-transformer-based-extractor" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="osc-transformer-based-extractor">
<span id="readme"></span><h1>OSC Transformer Based Extractor<a class="headerlink" href="#osc-transformer-based-extractor" title="Link to this heading">¶</a></h1>
<p><a class="reference external" href="https://os-climate.org/"><img alt="An OS-Climate Project" src="https://img.shields.io/badge/OS-Climate-blue" /></a> <a class="reference external" href="https://os-climate.slack.com"><img alt="Join OS-Climate on Slack" src="https://img.shields.io/badge/slack-osclimate-brightgreen.svg?logo=slack" /></a> <a class="reference external" href="https://github.com/ModeSevenIndustrialSolutions/osc-data-extractor"><img alt="Source code on GitHub" src="https://img.shields.io/badge/GitHub-100000?logo=github&amp;logoColor=white" /></a> <a class="reference external" href="https://pypi.org/project/osc-data-extractor/"><img alt="PyPI package" src="https://img.shields.io/pypi/v/osc-data-extractor.svg" /></a> <a class="reference external" href="https://cirrus-ci.com/github/os-climate/osc-data-extractor"><img alt="Build Status" src="https://api.cirrus-ci.com/github/os-climate/osc-data-extractor.svg?branch=main" /></a> <a class="reference external" href="https://pdm-project.org/latest/"><img alt="Built using PDM" src="https://img.shields.io/badge/PDM-Project-purple" /></a> <a class="reference external" href="https://pyscaffold.org/"><img alt="Project generated with PyScaffold" src="https://img.shields.io/badge/-PyScaffold-005CA0?logo=pyscaffold" /></a></p>
<section id="os-climate-data-extraction-tool">
<h2>OS-Climate Data Extraction Tool<a class="headerlink" href="#os-climate-data-extraction-tool" title="Link to this heading">¶</a></h2>
<p>This project provides a CLI tool and Python scripts to train Transformer models (via Hugging Face) for two primary tasks:
1. <strong>Relevance Detection</strong>: Determines if a question-context pair is relevant.
2. <strong>KPI Detection</strong>: Fine-tunes models to extract key performance indicators (KPIs) from datasets like annual reports and perform inference.</p>
<section id="quick-start">
<h3>Quick Start<a class="headerlink" href="#quick-start" title="Link to this heading">¶</a></h3>
<p>To install the tool, use pip:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>osc-transformer-based-extractor
</pre></div>
</div>
<p>After installation, you can access the CLI tool with:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>osc-transformer-based-extractor
</pre></div>
</div>
<p>This command will show the available commands and help via Typer, our CLI library.</p>
</section>
<section id="commands-and-workflow">
<h3>Commands and Workflow<a class="headerlink" href="#commands-and-workflow" title="Link to this heading">¶</a></h3>
<section id="relevance-detection">
<h4>1. Relevance Detection<a class="headerlink" href="#relevance-detection" title="Link to this heading">¶</a></h4>
<p><strong>Fine-tuning the Model:</strong></p>
<p>Assume your project structure looks like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>project/
│
├── kpi_mapping.csv
├── training_data.csv
├── data/
│   └── (JSON files for inference)
├── model/
│   └── (Model-related files)
├── saved__model/
│   └── (Output from training)
├── output/
│   └── (Results from inference)
</pre></div>
</div>
<p>Use the following command to fine-tune the model:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>osc-transformer-based-extractor<span class="w"> </span>relevance-detector<span class="w"> </span>fine-tune<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--data_path<span class="w"> </span><span class="s2">&quot;project/training_data.csv&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--model_name<span class="w"> </span><span class="s2">&quot;bert-base-uncased&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--num_labels<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--max_length<span class="w"> </span><span class="m">128</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--epochs<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--batch_size<span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--output_dir<span class="w"> </span><span class="s2">&quot;project/saved__model/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--save_steps<span class="w"> </span><span class="m">500</span>
</pre></div>
</div>
<p><strong>Running Inference:</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>osc-transformer-based-extractor<span class="w"> </span>relevance-detector<span class="w"> </span>perform-inference<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--folder_path<span class="w"> </span><span class="s2">&quot;project/data/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--kpi_mapping_path<span class="w"> </span><span class="s2">&quot;project/kpi_mapping.csv&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--output_path<span class="w"> </span><span class="s2">&quot;project/output/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--model_path<span class="w"> </span><span class="s2">&quot;project/model/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--tokenizer_path<span class="w"> </span><span class="s2">&quot;project/model/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--threshold<span class="w"> </span><span class="m">0</span>.5
</pre></div>
</div>
</section>
<section id="kpi-detection">
<h4>2. KPI Detection<a class="headerlink" href="#kpi-detection" title="Link to this heading">¶</a></h4>
<p>The KPI detection functionality includes <strong>fine-tuning</strong> and <strong>inference</strong>.</p>
<p><strong>Fine-tuning the KPI Model:</strong></p>
<p>Assume your project structure looks like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>project/
│
├── kpi_mapping.csv
├── training_data.csv
│
├── model/
│   └── (model-related files, e.g., tokenizer, config, checkpoints)
│
├── saved__model/
│   └── (Folder to store output from fine-tuning)
│
├── output/
│   └── (output files, e.g., inference_results.xlsx)
</pre></div>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>osc-transformer-based-extractor<span class="w"> </span>kpi-detection<span class="w"> </span>fine-tune<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--data_path<span class="w"> </span><span class="s2">&quot;project/training_data.csv&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--model_name<span class="w"> </span><span class="s2">&quot;bert-base-uncased&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--max_length<span class="w"> </span><span class="m">128</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--epochs<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--batch_size<span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--learning_rate<span class="w"> </span>5e-5<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output_dir<span class="w"> </span><span class="s2">&quot;project/saved__model/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--save_steps<span class="w"> </span><span class="m">500</span>
</pre></div>
</div>
<p><strong>Performing Inference:</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>osc-transformer-based-extractor<span class="w"> </span>kpi-detection<span class="w"> </span>inference<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--data_file_path<span class="w"> </span><span class="s2">&quot;project/data/input_dataset.csv&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output_path<span class="w"> </span><span class="s2">&quot;project/output/inference_results.xlsx&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--model_path<span class="w"> </span><span class="s2">&quot;project/model/&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="training-data-requirements">
<h3>Training Data Requirements<a class="headerlink" href="#training-data-requirements" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Relevance Detection Training File:</p></li>
</ol>
<p>The training file should have the following columns:
- <code class="docutils literal notranslate"><span class="pre">Question</span></code>
- <code class="docutils literal notranslate"><span class="pre">Context</span></code>
- <code class="docutils literal notranslate"><span class="pre">Label</span></code></p>
<p>Example:</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Training Data Example</span><a class="headerlink" href="#id1" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Question</p></th>
<th class="head"><p>Context</p></th>
<th class="head"><p>Label</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>What is the company name?</p></td>
<td><p>The Company is exposed to a risk…</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="2">
<li><p>KPI Detection Training File:</p></li>
</ol>
<p>For KPI detection, the dataset should have these additional columns:</p>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">KPI Detection Training Example</span><a class="headerlink" href="#id2" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Question</p></th>
<th class="head"><p>Context</p></th>
<th class="head"><p>Label</p></th>
<th class="head"><p>Company</p></th>
<th class="head"><p>Source File</p></th>
<th class="head"><p>KPI ID</p></th>
<th class="head"><p>Year</p></th>
<th class="head"><p>Answer</p></th>
<th class="head"><p>Data Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>What is the company name?</p></td>
<td><p>…</p></td>
<td><p>0</p></td>
<td><p>NOVATEK</p></td>
<td><p>04_NOVATEK_AR_2016_ENG_11.pdf</p></td>
<td><p>0</p></td>
<td><p>2016</p></td>
<td><p>PAO NOVATEK</p></td>
<td><p>TEXT</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="3">
<li><p>KPI Mapping File:</p></li>
</ol>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">KPI Mapping File Example</span><a class="headerlink" href="#id3" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>kpi_id</p></th>
<th class="head"><p>question</p></th>
<th class="head"><p>sectors</p></th>
<th class="head"><p>add_year</p></th>
<th class="head"><p>kpi_category</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>In which year was the annual report…</p></td>
<td><p>OG, CM, CU</p></td>
<td><p>FALSE</p></td>
<td><p>TEXT</p></td>
</tr>
</tbody>
</table>
</section>
<section id="developer-notes">
<h3>Developer Notes<a class="headerlink" href="#developer-notes" title="Link to this heading">¶</a></h3>
<section id="local-development">
<h4>Local Development<a class="headerlink" href="#local-development" title="Link to this heading">¶</a></h4>
<p>Clone the repository:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/os-climate/osc-transformer-based-extractor/
</pre></div>
</div>
<p>We use <strong>pdm</strong> for package management and <strong>tox</strong> for testing.</p>
<ol class="arabic">
<li><p>Install <code class="docutils literal notranslate"><span class="pre">pdm</span></code>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>pdm
</pre></div>
</div>
</li>
<li><p>Sync dependencies:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pdm<span class="w"> </span>sync
</pre></div>
</div>
</li>
<li><p>Add new packages (e.g., numpy):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pdm<span class="w"> </span>add<span class="w"> </span>numpy
</pre></div>
</div>
</li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">tox</span></code> for linting and testing:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>tox
$<span class="w"> </span>tox<span class="w"> </span>-e<span class="w"> </span>lint
$<span class="w"> </span>tox<span class="w"> </span>-e<span class="w"> </span><span class="nb">test</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="contributing">
<h3>Contributing<a class="headerlink" href="#contributing" title="Link to this heading">¶</a></h3>
<p>We welcome contributions! Please fork the repository and submit a pull request.
Ensure you sign off each commit with the <strong>Developer Certificate of Origin (DCO)</strong>.
Read more: <a class="reference external" href="http://developercertificate.org/">http://developercertificate.org/</a>.</p>
</section>
<section id="governance-transition">
<h3>Governance Transition<a class="headerlink" href="#governance-transition" title="Link to this heading">¶</a></h3>
<p>On June 26, 2024, the <strong>Linux Foundation</strong> announced the merger of <strong>FINOS</strong> with OS-Climate.
Projects are now transitioning to the [FINOS governance framework](<a class="reference external" href="https://community.finos.org/docs/governance">https://community.finos.org/docs/governance</a>).</p>
</section>
<section id="shields">
<h3>Shields<a class="headerlink" href="#shields" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://os-climate.org/"><img alt="An OS-Climate Project" src="https://img.shields.io/badge/OS-Climate-blue" /></a> <a class="reference external" href="https://os-climate.slack.com"><img alt="Join OS-Climate on Slack" src="https://img.shields.io/badge/slack-osclimate-brightgreen.svg?logo=slack" /></a> <a class="reference external" href="https://github.com/ModeSevenIndustrialSolutions/osc-data-extractor"><img alt="Source code on GitHub" src="https://img.shields.io/badge/GitHub-100000?logo=github&amp;logoColor=white" /></a> <a class="reference external" href="https://pypi.org/project/osc-data-extractor/"><img alt="PyPI package" src="https://img.shields.io/pypi/v/osc-data-extractor.svg" /></a> <a class="reference external" href="https://cirrus-ci.com/github/os-climate/osc-data-extractor"><img alt="Build Status" src="https://api.cirrus-ci.com/github/os-climate/osc-data-extractor.svg?branch=main" /></a> <a class="reference external" href="https://pdm-project.org/latest/"><img alt="Built using PDM" src="https://img.shields.io/badge/PDM-Project-purple" /></a> <a class="reference external" href="https://pyscaffold.org/"><img alt="Project generated with PyScaffold" src="https://img.shields.io/badge/-PyScaffold-005CA0?logo=pyscaffold" /></a></p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">osc-transformer-based-extractor</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#os-climate-data-extraction-tool">OS-Climate Data Extraction Tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributions &amp; Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">Module Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">osc-transformer-based-extractor</a></li>
      <li>Next: <a href="contributing.html" title="next chapter">Contributing</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023, Matthew Watkins.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/readme.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>